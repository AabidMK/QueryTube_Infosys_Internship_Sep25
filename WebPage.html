<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Video Semantic Search</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <style>
  body {
    background: radial-gradient(circle farthest-side at 70% 0,#e0ecff 0,#f6faff 80%,#eef4ff);
    font-family: 'Segoe UI', Arial, sans-serif;
    margin: 0;
    padding: 0;
    min-height: 100vh;
  }
  .container {
    max-width: 98vw;       /* increased for full width */
    width: 98vw;
    background: #fff;
    border-radius: 14px;
    box-shadow: 0 8px 40px 0 rgba(30,90,180,0.10);
    margin: 20px auto 20px auto;  /* smaller margin */
    padding: 32px 16px 40px 16px;
    display: flex;
    flex-direction: column;
    align-items: center;
  }
  h1 {
    text-align: center;
    color: #176be0;
    font-size: 2.5em;
    margin-bottom: 11px;
    letter-spacing: 0.01em;
    font-weight: 800;
  }
  .desc {
    text-align: center;
    color: #4c5c7c;
    margin-bottom: 30px;
    font-size: 1.14em;
    font-weight: 400;
    max-width: 520px;
  }
  .query-box {
    display: flex;
    gap: 12px;
    margin-bottom: 34px;
    width: 100%;
    max-width: 510px;
  }
  .query-box input {
    flex: 1;
    padding: 15px 16px;
    border: 1.3px solid #c6d4ee;
    border-radius: 7px;
    font-size: 1.08em;
    outline: none;
    transition: border-color 0.18s;
    font-family: inherit;
    background: #fafdff;
  }
  .query-box input:focus {
    border-color: #176be0;
    background: #fff;
  }
  .query-box button {
    padding: 0 32px;
    background: linear-gradient(90deg,#64b5ff,#1976d2 90%);
    color: #fff;
    border: none;
    border-radius: 7px;
    font-size: 1.14em;
    font-weight: 600;
    cursor: pointer;
    box-shadow: 0 2px 10px rgba(30,110,230,0.08);
    transition: background 0.17s;
    outline: none;
    height: 48px;
    letter-spacing: .03em;
  }
  .query-box button:disabled {
    background: #b3d4f6;
    cursor: wait;
    color: #f9fbfd;
  }
  .results {
    margin-top: 22px;
    width: 100%;
    display: flex;
    flex-wrap: wrap;
    gap: 24px;
    justify-content: flex-start;  /* align left for max use */
  }
  .video-card {
    background: #f6fafd;
    border-radius: 10px;
    box-shadow: 0 2px 14px rgba(110,190,240,.09), 0 1.5px 3.5px rgba(110,140,240,.04);
    margin-bottom: 5px;
    width: 23vw;         /* relative to window width */
    min-width: 270px;    /* minimum width to keep card size sane */
    max-width: 320px;    /* max width cap */
    display: flex;
    flex-direction: column;
    align-items: center;
    border-left: 7px solid #176be0;
    transition: transform 0.13s;
  }
  .video-card:hover {
    transform: translateY(-4px) scale(1.019);
    box-shadow: 0 10px 40px rgba(30,110,180,.14);
  }
  .thumb-container {
    width: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 16px 0 0 0;
  }
  .video-thumb {
    width: 91%;
    height: 180px;
    object-fit: cover;
    border-radius: 6px;
    box-shadow: 0 0.5px 6px #176be044;
    background: #e3effd;
    border: 1.1px solid #eaeefb;
  }
  .card-content {
    width: 90%;
    display: flex;
    flex-direction: column;
  }
  .video-card h2 {
    font-size: 1.15em;
    color: #1c366c;
    margin: 14px 0 5px 0;
    font-weight: 700;
    min-height: 48px;
  }
  .video-details {
    font-size: .99em;
    color: #588;
    margin-bottom: 5px;
    margin-top: 2px;
  }
  .score {
    font-size: .96em;
    color: #8e98a1;
    margin-bottom: 7px;
  }
  .video-link {
    color: #ff5384;
    background: #fafeff;
    border: 1.6px solid #ffa1c2;
    padding: 7px 24px;
    border-radius: 22px;
    text-decoration: none;
    font-weight: bold;
    transition: background 0.19s, border 0.19s;
    margin: 12px auto 13px auto;
    box-shadow: 0 1px 6px #faa1b614;
    letter-spacing: 0.017em;
    text-align: center;
    min-width: 120px;
    display: inline-block;
  }
  .video-link:hover {
    background: #fde2eb;
    color: #ed2c5f;
    text-decoration: underline;
    border-color: #fd6192;
  }
  .no-results {
    text-align: center;
    color: #999;
    font-size: 1.17em;
    margin-top: 22px;
    width: 100%;
  }
  /* Responsive mobile */
  @media (max-width: 700px) {
    .container {
      padding: 12px;
      max-width: 98vw;
    }
    .video-card {
      width: 99vw;
      min-width: 0;
    }
    .video-thumb {
      height: 150px;
    }
  }
</style>

</head>
<body>
  <div class="container">
    <h1>QueryTube_AI</h1>
    <div class="desc">Type in your query to discover relevant educational YouTube videos!</div>
    <div class="query-box">
      <input type="text" id="queryInput" placeholder="Enter your search query here..." autocomplete="off"/>
      <button id="submitBtn" onclick="fetchResults()">Search</button>
    </div>
    <div id="results" class="results"></div>
  </div>
  <script>
    const API_URL = "https://lilied-tomas-inexact.ngrok-free.dev/search"; // <-- replace with your current backend API

    function getThumbnail(video_id) {
      return `https://img.youtube.com/vi/${video_id}/hqdefault.jpg`;
    }

    async function fetchResults() {
      const queryInput = document.getElementById('queryInput');
      const button = document.getElementById('submitBtn');
      const resultsDiv = document.getElementById('results');
      const query = queryInput.value.trim();
      if (!query) return;
      button.disabled = true;
      resultsDiv.innerHTML = '<div class="no-results">Searching...</div>';
      try {
        const res = await fetch(API_URL, {
          method: 'POST',
          headers: {'Content-Type':'application/json'},
          body: JSON.stringify({query: query, top_k: 6})
        });
        if (!res.ok) throw new Error('API error');
        const data = await res.json();
        if (data.results && data.results.length > 0) {
          resultsDiv.innerHTML = '';
          data.results.forEach(item => {
            const video_id = (item.yt_link.match(/v=([A-Za-z0-9_\-]+)/) || [])[1] || '';
            resultsDiv.innerHTML += `
              <div class="video-card">
                <div class="thumb-container">
                  <img src="${getThumbnail(video_id)}" class="video-thumb" alt="Video thumbnail">
                </div>
                <div class="card-content">
                  <h2>${item.video_title || ''}</h2>
                  <div class="video-details">Channel: ${item.channel_title || ''}</div>
                  <div class="score">Similarity Score: ${item.distance_score.toFixed(3)}</div>

                  <a class="video-link" href="${item.yt_link}" target="_blank">Watch Video</a>
                </div>
              </div>
            `;
          });
        } else {
          resultsDiv.innerHTML = '<div class="no-results">No results found for your query.</div>';
        }
      } catch (err) {
        resultsDiv.innerHTML = `<div class="no-results">Error fetching results: ${err.message}</div>`;
      }
      button.disabled = false;
    }
  </script>
</body>
</html>
