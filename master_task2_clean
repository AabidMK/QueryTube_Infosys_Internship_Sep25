import pandas as pd
import re

# File paths
input_file = "valid_video_transcripts_serial.csv"   # Input file
output_file = "cleaned_transcript_details.csv"  # Output file

# Load dataset
df = pd.read_csv(input_file)

# Function to clean transcript
def clean_transcript(text):
    if pd.isna(text):
        return ""  # Handle missing transcripts
    
    # 1. Remove [Music], [Applause], etc.
    text = re.sub(r'\[.*?\]', '', text)
    
    # 2. Remove timestamps like 00:01, 1:23:45
    text = re.sub(r'\b\d{1,2}:\d{2}(?::\d{2})?\b', '', text)
    
    # 3. Remove special characters or non-UTF symbols
    text = re.sub(r'[^a-zA-Z0-9\s.,?!]', '', text)
    
    # 4. Convert to lowercase (except video id column handled separately)
    text = text.lower()
    
    # 5. Replace newlines with spaces
    text = text.replace("\n", " ")
    
    # Remove extra whitespace
    text = re.sub(r'\s+', ' ', text).strip()
    
    return text

# Apply cleaning only to transcript column
if 'transcript' in df.columns:
    df['transcript'] = df['transcript'].apply(clean_transcript)
else:
    print("Transcript column not found in dataset.")

# Save cleaned dataset
df.to_csv(output_file, index=False)

print(f"âœ… Cleaned transcript saved as {output_file}")
